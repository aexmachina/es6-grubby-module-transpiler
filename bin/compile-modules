#!/usr/bin/env node
"use strict";
var $__getDescriptors = function(object) {
  var descriptors = {}, name, names = Object.getOwnPropertyNames(object);
  for (var i = 0; i < names.length; i++) {
    var name = names[i];
    descriptors[name] = Object.getOwnPropertyDescriptor(object, name);
  }
  return descriptors;
}, $__createClassNoExtends = function(object, staticObject) {
  var ctor = object.constructor;
  Object.defineProperty(object, 'constructor', {enumerable: false});
  ctor.prototype = object;
  Object.defineProperties(ctor, $__getDescriptors(staticObject));
  return ctor;
};
var optimist = require("optimist");
var fs = require("fs");
var path = require("path");
var through = require("through");
function extend(target) {
  for (var sources = [], $__1 = 1; $__1 < arguments.length; $__1++) sources[$__1 - 1] = arguments[$__1];
  var toString = {}.toString;
  sources.forEach(function(source) {
    for (var key in source) {
      target[key] = source[key];
    }
  });
  return target;
}
var CLI = function() {
  'use strict';
  var $CLI = ($__createClassNoExtends)({
    constructor: function(Compiler) {
      var stdin = arguments[1] !== (void 0) ? arguments[1]: process.stdin;
      var stdout = arguments[2] !== (void 0) ? arguments[2]: process.stdout;
      var fs_ = arguments[3] !== (void 0) ? arguments[3]: fs;
      this.Compiler = Compiler;
      this.stdin = stdin;
      this.stdout = stdout;
      this.fs = fs_;
    },
    start: function(argv) {
      var options = this.parseArgs(argv);
      if (options.help) {
        this.argParser(argv).showHelp();
      } else if (options.stdio) {
        this.processStdio(options);
      } else {
        for (var i = 2; i < options._.length; i++) {
          var filename = options._[i];
          this.processPath(filename, options);
        }
      }
    },
    parseArgs: function(argv) {
      var args = this.argParser(argv).argv;
      if (args.imports) {
        var imports = {};
        args.imports.split(',').forEach(function(pair) {
          var $__2 = pair.split(':'), requirePath = $__2[0], global = $__2[1];
          imports[requirePath] = global;
        });
        args.imports = imports;
      }
      if (args.global) {
        args.into = args.global;
      }
      return args;
    },
    argParser: function(argv) {
      return optimist(argv).usage('compile-modules usage:\n\n  Using files:\n    compile-modules INPUT --to DIR [--infer-name] [--type TYPE] [--imports PATH:GLOBAL]\n\n  Using stdio:\n    compile-modules --stdio [--type TYPE] [--imports PATH:GLOBAL] [--module-name MOD]').options({
        type: {
          "default": 'amd',
          describe: 'The type of output (one of "amd", "yui", "cjs", or "globals")'
        },
        to: {describe: 'A directory in which to write the resulting files'},
        imports: {describe: 'A list of path:global pairs, comma separated (e.g. jquery:$,ember:Ember)'},
        'infer-name': {
          "default": false,
          type: 'boolean',
          describe: 'Automatically generate names for AMD and YUI modules'
        },
        'module-name': {
          describe: 'The name of the outputted module',
          alias: 'm'
        },
        stdio: {
          "default": false,
          type: 'boolean',
          alias: 's',
          describe: 'Use stdin and stdout to process a file'
        },
        global: {describe: 'When the type is `globals`, the name of the global to export into'},
        'not-strict': {
          "default": true,
          type: 'boolean',
          describe: 'Don\'t add \'use strict\' to the outputted module'
        },
        help: {
          "default": false,
          type: 'boolean',
          alias: 'h',
          describe: 'Shows this help message'
        }
      }).check((function($__2) {
        var type = $__2.type;
        return type === 'amd' || type === 'yui' || type === 'cjs' || type === 'globals';
      })).check((function(args) {
        return !args['infer-name'] || !args.m;
      })).check((function(args) {
        return (args.stdio && args.type === 'amd') ? !args['infer-name']: true;
      })).check((function(args) {
        return (args.stdio && args.type === 'yui') ? !args['infer-name']: true;
      })).check((function(args) {
        return args.stdio || args.to || args.help;
      })).check((function(args) {
        return args.imports ? args.type === 'globals': args.type !== 'globals';
      }));
    },
    processStdio: function(options) {
      this.processIO(this.stdin, this.stdout, options);
    },
    processIO: function(input, output, options) {
      try {
        throw undefined;
      } catch (end) {
        try {
          throw undefined;
        } catch (write) {
          var data = '', self = this;
          write = function(chunk) {
            data += chunk;
          };
          end = function() {
            this.queue(self._compile(data, options.m, options.type, options));
            this.queue(null);
          };
          input.pipe(through(write, end)).pipe(output);
        }
      }
    },
    processPath: function(filename, options) {
      this.fs.stat(filename, function(err, stat) {
        if (err) {
          throw new Error(err);
        } else if (stat.isDirectory()) {
          this.processDirectory(filename, options);
        } else {
          this.processFile(filename, options);
        }
      }.bind(this));
    },
    processDirectory: function(dirname, options) {
      this.fs.readdir(dirname, function(err, children) {
        if (err) {
          console.error(err.message);
          process.exit(1);
        }
        children.forEach(function(child) {
          this.processPath(path.join(dirname, child), options);
        }.bind(this));
      }.bind(this));
    },
    processFile: function(filename, options) {
      try {
        throw undefined;
      } catch (normalizePath) {
        normalizePath = function(p) {
          return p.replace(/\\/g, '/');
        };
        var ext = path.extname(filename), basenameNoExt = path.basename(filename, ext), dirname = path.dirname(filename), pathNoExt = normalizePath(path.join(dirname, basenameNoExt)), output, outputFilename = normalizePath(path.join(options.to, filename)), moduleName = options['infer-name'] ? pathNoExt: null;
        options = extend({}, options, {m: moduleName});
        this._mkdirp(path.dirname(outputFilename));
        this.processIO(this.fs.createReadStream(filename), this.fs.createWriteStream(outputFilename), options);
      }
    },
    _compile: function(input, moduleName, type, options) {
      var compiler, method;
      type = {
        amd: 'AMD',
        yui: 'YUI',
        cjs: 'CJS',
        globals: 'Globals'
      }[type];
      compiler = new this.Compiler(input, moduleName, options);
      method = "to" + type;
      return compiler[method]();
    },
    _mkdirp: function(directory) {
      var prefix;
      if (this.fs.existsSync(directory)) {
        return;
      }
      prefix = path.dirname(directory);
      if (prefix !== '.' && prefix !== '/') {
        this._mkdirp(prefix);
      }
      return this.fs.mkdirSync(directory);
    }
  }, {});
  return $CLI;
}();
CLI.start = function(Compiler, argv) {
  var stdin = arguments[2] !== (void 0) ? arguments[2]: process.stdin;
  var stdout = arguments[3] !== (void 0) ? arguments[3]: process.stdout;
  var fs_ = arguments[4] !== (void 0) ? arguments[4]: fs;
  return new CLI(Compiler, stdin, stdout, fs_).start(argv);
};
function requireMain() {
  var root = path.join(__dirname, '..'), pkgPath = path.join(root, 'package.json'), pkg = JSON.parse(fs.readFileSync(pkgPath, 'utf8'));
  return require(path.join(root, pkg.main));
}
var Compiler = requireMain().Compiler;
CLI.start(Compiler, process.argv);

//@ sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG1wL3RyYW5zcGlsZWQvY29tcGlsZS1tb2R1bGVzLmpzLmVzNiIsInNvdXJjZXMiOlsidG1wL3RyYW5zcGlsZWQvY29tcGlsZS1tb2R1bGVzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFlBQUE7dUJDQUEsU0FBQSxDQUFTLE1BQUEsQ0FBUTtBQUNMLEtBQUEsWUFBQSxFQUFjLEVBQUEsQ0FBQSxDQUFJLEtBQUEsQ0FBTSxNQUFBLEVBQVEsT0FBQSxDQUFBLG1CQUEwQixDQUFDLE1BQUEsQ0FBQTtBQUMvRCxLQUFBLEVBQVMsR0FBQSxFQUFBLEVBQUksRUFBQSxDQUFHLEVBQUEsRUFBSSxNQUFBLENBQUEsTUFBQSxDQUFjLEVBQUEsRUFBQSxDQUFLO0FBQ2pDLE9BQUEsS0FBQSxFQUFPLE1BQUEsQ0FBTSxDQUFBLENBQUE7QUFDakIsZUFBQSxDQUFZLElBQUEsQ0FBQSxFQUFRLE9BQUEsQ0FBQSx3QkFBK0IsQ0FBQyxNQUFBLENBQVEsS0FBQSxDQUFBO0FBQUE7QUFFOUQsUUFBTyxZQUFBO0FBQUEsQ0FBQSwyQkNOZixTQUFBLENBQVMsTUFBQSxDQUFRLGFBQUEsQ0FBYztBQUNyQixLQUFBLEtBQUEsRUFBTyxPQUFBLENBQUEsV0FBQTtBQUNYLFFBQUEsQ0FBQSxjQUFxQixDQUFDLE1BQUEsQ0FBUSxjQUFBLENBQWUsRUFBQyxVQUFBLENBQVksTUFBQSxDQUFBLENBQUE7QUFDMUQsTUFBQSxDQUFBLFNBQUEsRUFBaUIsT0FBQTtBQUNqQixRQUFBLENBQUEsZ0JBQXVCLENBQUMsSUFBQSxDQUFNLGtCQUFpQixDQUFDLFlBQUEsQ0FBQSxDQUFBO0FBQ2hELFFBQU8sS0FBQTtBQUFBLENBQUE7QUZKVCxHQUFBLFNBQUEsRUFBVyxRQUFPLENBQUMsVUFBQSxDQUFBO0FBQ25CLEdBQUEsR0FBQSxFQUFLLFFBQU8sQ0FBQyxJQUFBLENBQUE7QUFDYixHQUFBLEtBQUEsRUFBTyxRQUFPLENBQUMsTUFBQSxDQUFBO0FBQ2YsR0FBQSxRQUFBLEVBQVUsUUFB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QUFVLENBQUMsRUFBQSxDQUFBLFlBQWUsQ0FBQyxPQUFBLENBQVMsT0FBQSxDQUFBLENBQUE7QUFFbEQsUUFBTyxRQUFPLENBQUMsSUFBQSxDQUFBLElBQVMsQ0FBQyxJQUFBLENBQU0sSUFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBO0FBQUE7R0FHN0IsU0FBQSxFQUFXLFlBQVcsQ0FBQSxDQUFBLENBQUEsUUFBQTtBQUUxQixHQUFBLENBQUEsS0FBUyxDQUFDLFFBQUEsQ0FBVSxRQUFBLENBQUEsSUFBQSxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgb3B0aW1pc3QgPSByZXF1aXJlKFwib3B0aW1pc3RcIik7XG52YXIgZnMgPSByZXF1aXJlKFwiZnNcIik7XG52YXIgcGF0aCA9IHJlcXVpcmUoXCJwYXRoXCIpO1xudmFyIHRocm91Z2ggPSByZXF1aXJlKFwidGhyb3VnaFwiKTtcblxuZnVuY3Rpb24gZXh0ZW5kKHRhcmdldCwgLi4uc291cmNlcykge1xuICB2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZztcblxuICBzb3VyY2VzLmZvckVhY2goZnVuY3Rpb24oc291cmNlKSB7XG4gICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkge1xuICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiB0YXJnZXQ7XG59XG5cbmNsYXNzIENMSSB7XG4gIGNvbnN0cnVjdG9yKENvbXBpbGVyLCBzdGRpbj1wcm9jZXNzLnN0ZGluLCBzdGRvdXQ9cHJvY2Vzcy5zdGRvdXQsIGZzXz1mcykge1xuICAgIHRoaXMuQ29tcGlsZXIgPSBDb21waWxlcjtcbiAgICB0aGlzLnN0ZGluID0gc3RkaW47XG4gICAgdGhpcy5zdGRvdXQgPSBzdGRvdXQ7XG4gICAgdGhpcy5mcyA9IGZzXztcbiAgfVxuXG4gIHN0YXJ0KGFyZ3YpIHtcbiAgICB2YXIgb3B0aW9ucyA9IHRoaXMucGFyc2VBcmdzKGFyZ3YpO1xuXG4gICAgaWYgKG9wdGlvbnMuaGVscCkge1xuICAgICAgdGhpcy5hcmdQYXJzZXIoYXJndikuc2hvd0hlbHAoKTtcbiAgICB9IGVsc2UgaWYgKG9wdGlvbnMuc3RkaW8pIHtcbiAgICAgIHRoaXMucHJvY2Vzc1N0ZGlvKG9wdGlvbnMpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKHZhciBpID0gMjsgaSA8IG9wdGlvbnMuXy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgZmlsZW5hbWUgPSBvcHRpb25zLl9baV07XG4gICAgICAgIHRoaXMucHJvY2Vzc1BhdGgoZmlsZW5hbWUsIG9wdGlvbnMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHBhcnNlQXJncyhhcmd2KSB7XG4gICAgdmFyIGFyZ3MgPSB0aGlzLmFyZ1BhcnNlcihhcmd2KS5hcmd2O1xuXG4gICAgaWYgKGFyZ3MuaW1wb3J0cykge1xuICAgICAgdmFyIGltcG9ydHMgPSB7fTtcbiAgICAgIGFyZ3MuaW1wb3J0cy5zcGxpdCgnLCcpLmZvckVhY2goZnVuY3Rpb24ocGFpcikge1xuICAgICAgICB2YXIgW3JlcXVpcmVQYXRoLCBnbG9iYWxdID0gcGFpci5zcGxpdCgnOicpO1xuICAgICAgICBpbXBvcnRzW3JlcXVpcmVQYXRoXSA9IGdsb2JhbDtcbiAgICAgIH0pO1xuICAgICAgYXJncy5pbXBvcnRzID0gaW1wb3J0cztcbiAgICB9XG5cbiAgICBpZiAoYXJncy5nbG9iYWwpIHtcbiAgICAgIGFyZ3MuaW50byA9IGFyZ3MuZ2xvYmFsO1xuICAgIH1cblxuICAgIHJldHVybiBhcmdzO1xuICB9XG5cbiAgYXJnUGFyc2VyKGFyZ3YpIHtcbiAgICByZXR1cm4gb3B0aW1pc3QoYXJndikudXNhZ2UoJ2NvbXBpbGUtbW9kdWxlcyB1c2FnZTpcXG5cXG4gIFVzaW5nIGZpbGVzOlxcbiAgICBjb21waWxlLW1vZHVsZXMgSU5QVVQgLS10byBESVIgWy0taW5mZXItbmFtZV0gWy0tdHlwZSBUWVBFXSBbLS1pbXBvcnRzIFBBVEg6R0xPQkFMXVxcblxcbiAgVXNpbmcgc3RkaW86XFxuICAgIGNvbXBpbGUtbW9kdWxlcyAtLXN0ZGlvIFstLXR5cGUgVFlQRV0gWy0taW1wb3J0cyBQQVRIOkdMT0JBTF0gWy0tbW9kdWxlLW5hbWUgTU9EXScpLm9wdGlvbnMoe1xuICAgICAgdHlwZToge1xuICAgICAgICBcImRlZmF1bHRcIjogJ2FtZCcsXG4gICAgICAgIGRlc2NyaWJlOiAnVGhlIHR5cGUgb2Ygb3V0cHV0IChvbmUgb2YgXCJhbWRcIiwgXCJ5dWlcIiwgXCJjanNcIiwgb3IgXCJnbG9iYWxzXCIpJ1xuICAgICAgfSxcbiAgICAgIHRvOiB7XG4gICAgICAgIGRlc2NyaWJlOiAnQSBkaXJlY3RvcnkgaW4gd2hpY2ggdG8gd3JpdGUgdGhlIHJlc3VsdGluZyBmaWxlcydcbiAgICAgIH0sXG4gICAgICBpbXBvcnRzOiB7XG4gICAgICAgIGRlc2NyaWJlOiAnQSBsaXN0IG9mIHBhdGg6Z2xvYmFsIHBhaXJzLCBjb21tYSBzZXBhcmF0ZWQgKGUuZy4ganF1ZXJ5OiQsZW1iZXI6RW1iZXIpJ1xuICAgICAgfSxcbiAgICAgICdpbmZlci1uYW1lJzoge1xuICAgICAgICBcImRlZmF1bHRcIjogZmFsc2UsXG4gICAgICAgIHR5cGU6ICdib29sZWFuJyxcbiAgICAgICAgZGVzY3JpYmU6ICdBdXRvbWF0aWNhbGx5IGdlbmVyYXRlIG5hbWVzIGZvciBBTUQgYW5kIFlVSSBtb2R1bGVzJ1xuICAgICAgfSxcbiAgICAgICdtb2R1bGUtbmFtZSc6IHtcbiAgICAgICAgZGVzY3JpYmU6ICdUaGUgbmFtZSBvZiB0aGUgb3V0cHV0dGVkIG1vZHVsZScsXG4gICAgICAgIGFsaWFzOiAnbSdcbiAgICAgIH0sXG4gICAgICBzdGRpbzoge1xuICAgICAgICBcImRlZmF1bHRcIjogZmFsc2UsXG4gICAgICAgIHR5cGU6ICdib29sZWFuJyxcbiAgICAgICAgYWxpYXM6ICdzJyxcbiAgICAgICAgZGVzY3JpYmU6ICdVc2Ugc3RkaW4gYW5kIHN0ZG91dCB0byBwcm9jZXNzIGEgZmlsZSdcbiAgICAgIH0sXG4gICAgICBnbG9iYWw6IHtcbiAgICAgICAgZGVzY3JpYmU6ICdXaGVuIHRoZSB0eXBlIGlzIGBnbG9iYWxzYCwgdGhlIG5hbWUgb2YgdGhlIGdsb2JhbCB0byBleHBvcnQgaW50bydcbiAgICAgIH0sXG4gICAgICAnbm90LXN0cmljdCc6IHtcbiAgICAgICAgXCJkZWZhdWx0XCI6IHRydWUsXG4gICAgICAgIHR5cGU6ICdib29sZWFuJyxcbiAgICAgICAgZGVzY3JpYmU6ICdEb25cXCd0IGFkZCBcXCd1c2Ugc3RyaWN0XFwnIHRvIHRoZSBvdXRwdXR0ZWQgbW9kdWxlJ1xuICAgICAgfSxcbiAgICAgIGhlbHA6IHtcbiAgICAgICAgXCJkZWZhdWx0XCI6IGZhbHNlLFxuICAgICAgICB0eXBlOiAnYm9vbGVhbicsXG4gICAgICAgIGFsaWFzOiAnaCcsXG4gICAgICAgIGRlc2NyaWJlOiAnU2hvd3MgdGhpcyBoZWxwIG1lc3NhZ2UnXG4gICAgICB9XG4gICAgfSkuY2hlY2soKHt0eXBlfSkgPT4gdHlwZSA9PT0gJ2FtZCcgfHwgdHlwZSA9PT0gJ3l1aScgfHwgdHlwZSA9PT0gJ2NqcycgfHwgdHlwZSA9PT0gJ2dsb2JhbHMnKVxuICAgIC5jaGVjayhhcmdzID0+ICFhcmdzWydpbmZlci1uYW1lJ10gfHwgIWFyZ3MubSlcbiAgICAuY2hlY2soYXJncyA9PiAoYXJncy5zdGRpbyAmJiBhcmdzLnR5cGUgPT09ICdhbWQnKSA/ICFhcmdzWydpbmZlci1uYW1lJ10gOiB0cnVlKVxuICAgIC5jaGVjayhhcmdzID0+IChhcmdzLnN0ZGlvICYmIGFyZ3MudHlwZSA9PT0gJ3l1aScpID8gIWFyZ3NbJ2luZmVyLW5hbWUnXSA6IHRydWUpXG4gICAgLmNoZWNrKGFyZ3MgPT4gYXJncy5zdGRpbyB8fCBhcmdzLnRvIHx8IGFyZ3MuaGVscClcbiAgICAuY2hlY2soYXJncyA9PiBhcmdzLmltcG9ydHMgPyBhcmdzLnR5cGUgPT09ICdnbG9iYWxzJyA6IGFyZ3MudHlwZSAhPT0gJ2dsb2JhbHMnKTtcbiAgfVxuXG4gIHByb2Nlc3NTdGRpbyhvcHRpb25zKSB7XG4gICAgdGhpcy5wcm9jZXNzSU8odGhpcy5zdGRpbiwgdGhpcy5zdGRvdXQsIG9wdGlvbnMpO1xuICB9XG5cbiAgcHJvY2Vzc0lPKGlucHV0LCBvdXRwdXQsIG9wdGlvbnMpIHtcbiAgICB2YXIgZGF0YSA9ICcnLFxuICAgICAgICBzZWxmID0gdGhpcztcblxuICAgIGZ1bmN0aW9uIHdyaXRlKGNodW5rKSB7XG4gICAgICBkYXRhICs9IGNodW5rO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVuZCgpIHtcbiAgICAgIC8qIGpzaGludCAtVzA0MCAqL1xuICAgICAgdGhpcy5xdWV1ZShzZWxmLl9jb21waWxlKGRhdGEsIG9wdGlvbnMubSwgb3B0aW9ucy50eXBlLCBvcHRpb25zKSk7XG4gICAgICB0aGlzLnF1ZXVlKG51bGwpO1xuICAgIH1cblxuICAgIGlucHV0LnBpcGUodGhyb3VnaCh3cml0ZSwgZW5kKSkucGlwZShvdXRwdXQpO1xuICB9XG5cbiAgcHJvY2Vzc1BhdGgoZmlsZW5hbWUsIG9wdGlvbnMpIHtcbiAgICB0aGlzLmZzLnN0YXQoZmlsZW5hbWUsIGZ1bmN0aW9uKGVyciwgc3RhdCkge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyKTtcbiAgICAgIH0gZWxzZSBpZiAoc3RhdC5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgIHRoaXMucHJvY2Vzc0RpcmVjdG9yeShmaWxlbmFtZSwgb3B0aW9ucyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnByb2Nlc3NGaWxlKGZpbGVuYW1lLCBvcHRpb25zKTtcbiAgICAgIH1cbiAgICB9LmJpbmQodGhpcykpO1xuICB9XG5cbiAgcHJvY2Vzc0RpcmVjdG9yeShkaXJuYW1lLCBvcHRpb25zKSB7XG4gICAgdGhpcy5mcy5yZWFkZGlyKGRpcm5hbWUsIGZ1bmN0aW9uKGVyciwgY2hpbGRyZW4pIHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIubWVzc2FnZSk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH1cbiAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oY2hpbGQpIHtcbiAgICAgICAgdGhpcy5wcm9jZXNzUGF0aChwYXRoLmpvaW4oZGlybmFtZSwgY2hpbGQpLCBvcHRpb25zKTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIHByb2Nlc3NGaWxlKGZpbGVuYW1lLCBvcHRpb25zKSB7XG4gICAgZnVuY3Rpb24gbm9ybWFsaXplUGF0aChwKSB7XG4gICAgICByZXR1cm4gcC5yZXBsYWNlKC9cXFxcL2csICcvJyk7XG4gICAgfVxuXG4gICAgdmFyIGV4dCAgICAgICAgICAgID0gcGF0aC5leHRuYW1lKGZpbGVuYW1lKSxcbiAgICAgICAgYmFzZW5hbWVOb0V4dCAgPSBwYXRoLmJhc2VuYW1lKGZpbGVuYW1lLCBleHQpLFxuICAgICAgICBkaXJuYW1lICAgICAgICA9IHBhdGguZGlybmFtZShmaWxlbmFtZSksXG4gICAgICAgIHBhdGhOb0V4dCAgICAgID0gbm9ybWFsaXplUGF0aChwYXRoLmpvaW4oZGlybmFtZSwgYmFzZW5hbWVOb0V4dCkpLFxuICAgICAgICBvdXRwdXQsXG4gICAgICAgIG91dHB1dEZpbGVuYW1lID0gbm9ybWFsaXplUGF0aChwYXRoLmpvaW4ob3B0aW9ucy50bywgZmlsZW5hbWUpKSxcbiAgICAgICAgbW9kdWxlTmFtZSAgICAgPSBvcHRpb25zWydpbmZlci1uYW1lJ10gPyBwYXRoTm9FeHQgOiBudWxsO1xuXG4gICAgb3B0aW9ucyA9IGV4dGVuZCh7fSwgb3B0aW9ucywge206IG1vZHVsZU5hbWV9KTtcbiAgICB0aGlzLl9ta2RpcnAocGF0aC5kaXJuYW1lKG91dHB1dEZpbGVuYW1lKSk7XG5cbiAgICB0aGlzLnByb2Nlc3NJTyhcbiAgICAgIHRoaXMuZnMuY3JlYXRlUmVhZFN0cmVhbShmaWxlbmFtZSksXG4gICAgICB0aGlzLmZzLmNyZWF0ZVdyaXRlU3RyZWFtKG91dHB1dEZpbGVuYW1lKSxcbiAgICAgIG9wdGlvbnNcbiAgICApO1xuICB9XG5cbiAgX2NvbXBpbGUoaW5wdXQsIG1vZHVsZU5hbWUsIHR5cGUsIG9wdGlvbnMpIHtcbiAgICB2YXIgY29tcGlsZXIsIG1ldGhvZDtcbiAgICB0eXBlID0ge1xuICAgICAgYW1kOiAnQU1EJyxcbiAgICAgIHl1aTogJ1lVSScsXG4gICAgICBjanM6ICdDSlMnLFxuICAgICAgZ2xvYmFsczogJ0dsb2JhbHMnXG4gICAgfVt0eXBlXTtcbiAgICBjb21waWxlciA9IG5ldyB0aGlzLkNvbXBpbGVyKGlucHV0LCBtb2R1bGVOYW1lLCBvcHRpb25zKTtcbiAgICBtZXRob2QgPSBcInRvXCIgKyB0eXBlO1xuICAgIHJldHVybiBjb21waWxlclttZXRob2RdKCk7XG4gIH1cblxuICBfbWtkaXJwKGRpcmVjdG9yeSkge1xuICAgIHZhciBwcmVmaXg7XG4gICAgaWYgKHRoaXMuZnMuZXhpc3RzU3luYyhkaXJlY3RvcnkpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHByZWZpeCA9IHBhdGguZGlybmFtZShkaXJlY3RvcnkpO1xuICAgIGlmIChwcmVmaXggIT09ICcuJyAmJiBwcmVmaXggIT09ICcvJykge1xuICAgICAgdGhpcy5fbWtkaXJwKHByZWZpeCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmZzLm1rZGlyU3luYyhkaXJlY3RvcnkpO1xuICB9XG59XG5cbkNMSS5zdGFydCA9IGZ1bmN0aW9uKENvbXBpbGVyLCBhcmd2LCBzdGRpbj1wcm9jZXNzLnN0ZGluLCBzdGRvdXQ9cHJvY2Vzcy5zdGRvdXQsIGZzXz1mcykge1xuICByZXR1cm4gbmV3IENMSShDb21waWxlciwgc3RkaW4sIHN0ZG91dCwgZnNfKS5zdGFydChhcmd2KTtcbn07XG5cbmZ1bmN0aW9uIHJlcXVpcmVNYWluKCkge1xuICB2YXIgcm9vdCAgICA9IHBhdGguam9pbihfX2Rpcm5hbWUsICcuLicpLFxuICAgICAgcGtnUGF0aCA9IHBhdGguam9pbihyb290LCAncGFja2FnZS5qc29uJyksXG4gICAgICBwa2cgICAgID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMocGtnUGF0aCwgJ3V0ZjgnKSk7XG5cbiAgcmV0dXJuIHJlcXVpcmUocGF0aC5qb2luKHJvb3QsIHBrZy5tYWluKSk7XG59XG5cbmxldCBDb21waWxlciA9IHJlcXVpcmVNYWluKCkuQ29tcGlsZXI7XG5cbkNMSS5zdGFydChDb21waWxlciwgcHJvY2Vzcy5hcmd2KTtcbiJdfQ==